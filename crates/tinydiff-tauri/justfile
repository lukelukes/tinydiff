set quiet
set shell := ["bash", "-euo", "pipefail", "-c"]

export RUST_LOG := env("RUST_LOG", "debug")

[group('check')]
fmt:
    cargo fmt

[group('check')]
fmt-check:
    cargo fmt -- --check

[group('check')]
clippy:
    cargo clippy --all-targets -- -D warnings

[group('check')]
test:
    cargo test

[group('check')]
[parallel]
check: fmt clippy test

[group('dev')]
build:
    cargo build --release

[group('dev')]
[no-exit-message]
run:
    cargo run

[group('dev')]
[no-exit-message]
fix:
    cargo clippy --all-targets --fix --allow-dirty

[group('dev')]
[confirm("This will remove all build artifacts. Continue?")]
clean:
    cargo clean

ci: check
    @echo "All checks passed!"
